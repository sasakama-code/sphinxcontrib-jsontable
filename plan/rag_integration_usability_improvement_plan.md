# ğŸš€ RAGçµ±åˆå®Ÿç”¨æ€§æ”¹å–„è¨ˆç”»æ›¸ (Ultrathink Mode)

**ä½œæˆæ—¥**: 2025å¹´6æœˆ10æ—¥  
**å¯¾è±¡**: sphinxcontrib-jsontable RAGçµ±åˆæ©Ÿèƒ½  
**èª²é¡Œ**: æŠ€è¡“å®Ÿè£…å®Œäº†å¾Œã®å®Ÿç”¨æ€§ãƒ»ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£æ”¹å–„  

---

## ğŸ“Š **ç¾çŠ¶åˆ†æã¨èª²é¡Œç‰¹å®š**

### ğŸ” **ç‰¹å®šã•ã‚ŒãŸä¸»è¦èª²é¡Œ**

#### 1. **ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ä¸æ˜ç¢ºå•é¡Œ**
```
âŒ ç¾çŠ¶ã®å•é¡Œ:
- RAGé€£æºè¨­å®šã‚’æœ‰åŠ¹åŒ–ã—ãŸå¾Œã®å…·ä½“çš„ãªä½¿ç”¨æ–¹æ³•ãŒä¸æ˜
- ã€Œãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’é£Ÿã‚ã›ã‚‹ã€vsã€Œãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ã‚’é£Ÿã‚ã›ã‚‹ã€ã®é¸æŠåŸºæº–ãŒãªã„
- å®Ÿéš›ã®ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤ãŒè¦‹ãˆãªã„
- Excelãƒ‡ãƒ¼ã‚¿ã¨ã®é€£æºãƒ‘ã‚¿ãƒ¼ãƒ³ãŒæœªå¯¾å¿œ
```

#### 2. **æ—¢å­˜ã‚·ã‚¹ãƒ†ãƒ é€£æºæœªå¯¾å¿œ**
```
âŒ ç¾çŠ¶ã®å•é¡Œ:
- æ—¢å­˜RAGã‚·ã‚¹ãƒ†ãƒ ï¼ˆOpenAIã€LangChainã€Vector DBsï¼‰ã¨ã®é€£æºæ–¹æ³•ãŒä¸æ˜
- ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ä½œæˆãƒ«ãƒ¼ãƒ«ã®å·®ç•°ã‚’å¸åã™ã‚‹ä»•çµ„ã¿ãŒãªã„
- æ¨™æº–çš„ãªRAGãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¨ã®çµ±åˆæ–¹æ³•ãŒæœªå®šç¾©
- Excel â†’ JSON â†’ RAG ã®è‡ªå‹•åŒ–ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãŒãªã„
```

#### 3. **å®Ÿè£…ã‚¬ã‚¤ãƒ‰ä¸è¶³**
```
âŒ ç¾çŠ¶ã®å•é¡Œ:
- READMEç­‰ã§ã‚´ãƒ¼ãƒ«ãŒè¦‹ãˆãªã„
- ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã®å°å…¥æ–¹æ³•ãŒãªã„
- å…·ä½“çš„ãªã‚³ãƒ¼ãƒ‰ä¾‹ã‚„ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ãŒãªã„
- Excelé€£æºã®å…·ä½“çš„ãªæ‰‹é †ãŒæœªæ•´å‚™
```

#### 4. **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æŸ”è»Ÿæ€§ä¸è¶³**
```
âŒ ç¾çŠ¶ã®å•é¡Œ:
- ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºæ€§ãŒä½ã„
- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³åŒ–ã•ã‚Œã¦ã„ãªã„
- ä¼æ¥­ç’°å¢ƒã§ã®å¤šæ§˜ãªãƒ‹ãƒ¼ã‚ºã«å¯¾å¿œã§ããªã„
- Excelå½¢å¼ã®å¤šæ§˜æ€§ã«å¯¾å¿œã§ããªã„
```

---

## ğŸ¯ **åŒ…æ‹¬çš„æ”¹å–„æˆ¦ç•¥**

### **æˆ¦ç•¥1: Excelçµ±åˆã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ **
```mermaid
graph TD
    A[Excel Spreadsheet] --> B[JSON Export Tool]
    B --> C[jsontable RAG]
    C --> D[Vector DB]
    D --> E[AI-Powered Excel Insights]
    E --> F[Business Intelligence]
```

### **æˆ¦ç•¥2: ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹é§†å‹•è¨­è¨ˆ**
```mermaid
graph TD
    A[ä¼æ¥­ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ] --> B[jsontable RAG]
    B --> C[ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ]
    C --> D[Vector DB]
    D --> E[æ¤œç´¢ãƒ»QA ã‚·ã‚¹ãƒ†ãƒ ]
    E --> F[ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤å®Ÿç¾]
```

### **æˆ¦ç•¥3: ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ çµ±åˆ**
```mermaid
graph LR
    A[jsontable] --> B[OpenAI API]
    A --> C[LangChain]
    A --> D[Chroma/Pinecone]
    A --> E[Elasticsearch]
    A --> F[Custom RAG]
```

---

## ğŸ“‹ **è©³ç´°æ”¹å–„è¨ˆç”»**

### **1. Excelé€£æºãƒ‘ã‚¿ãƒ¼ãƒ³è¨­è¨ˆ**

#### **1.1 Excel â†’ JSON â†’ RAG ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³**

**ãƒ‘ã‚¿ãƒ¼ãƒ³A: å–¶æ¥­ãƒ‡ãƒ¼ã‚¿Excelé€£æº**
```python
# Excel â†’ JSON å¤‰æ›ãƒ„ãƒ¼ãƒ«
import pandas as pd
from sphinxcontrib.jsontable.tools import ExcelToRAGConverter

# Step 1: Excelãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿è¾¼ã¿ã¨å¤‰æ›
converter = ExcelToRAGConverter()
json_data = converter.convert_excel_to_json(
    excel_file="sales_report.xlsx",
    sheet_name="Q1_Sales",
    rag_purpose="sales-analysis",
    entity_mapping={
        "æ‹…å½“è€…": "person",
        "åœ°åŸŸ": "region", 
        "å•†å“å": "product",
        "å£²ä¸Š": "revenue"
    }
)

# Step 2: è‡ªå‹•JSONå‡ºåŠ›
json_data.save("sales_report.json")

# Step 3: Sphinxæ–‡æ›¸ã¸ã®è‡ªå‹•çµ±åˆ
sphinx_template = """
å–¶æ¥­å®Ÿç¸¾åˆ†æ
============

.. enhanced-jsontable:: {json_file}
   :rag-metadata: true
   :rag-purpose: sales-analysis
   :entity-types: person,region,product,revenue
   :excel-source: {excel_file}
   :auto-update: daily
   :header:
"""

with open("sales_analysis.rst", "w") as f:
    f.write(sphinx_template.format(
        json_file="sales_report.json",
        excel_file="sales_report.xlsx"
    ))
```

**æœŸå¾…ã•ã‚Œã‚‹æˆæœ**:
- ã€Œé–¢æ±åœ°åŸŸã®ãƒˆãƒƒãƒ—ã‚»ãƒ¼ãƒ«ã‚¹ã¯èª°ï¼Ÿã€
- ã€Œå•†å“Aã®å£²ä¸Šãƒˆãƒ¬ãƒ³ãƒ‰ã‚’æ•™ãˆã¦ã€
- ã€Œå‰å››åŠæœŸã¨æ¯”è¼ƒã—ãŸæˆé•·ç‡ã¯ï¼Ÿã€

**ãƒ‘ã‚¿ãƒ¼ãƒ³B: åœ¨åº«ç®¡ç†Excelé€£æº**
```python
# åœ¨åº«ç®¡ç†Excelã®è‡ªå‹•RAGåŒ–
inventory_converter = ExcelToRAGConverter()
inventory_data = inventory_converter.convert_excel_to_json(
    excel_file="inventory_master.xlsx",
    sheets=["ç¾åœ¨åœ¨åº«", "å…¥è·äºˆå®š", "ç™ºæ³¨å±¥æ­´"],
    rag_purpose="inventory-management",
    auto_entity_detection=True,  # è‡ªå‹•ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£èªè­˜
    business_context="è£½é€ æ¥­åœ¨åº«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ "
)

# è¤‡æ•°ã‚·ãƒ¼ãƒˆã®çµ±åˆãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
inventory_data.create_federated_metadata(
    federation_name="inventory-system",
    cross_sheet_relationships={
        "å•†å“ã‚³ãƒ¼ãƒ‰": ["ç¾åœ¨åœ¨åº«", "å…¥è·äºˆå®š", "ç™ºæ³¨å±¥æ­´"],
        "ä»•å…¥å…ˆ": ["å…¥è·äºˆå®š", "ç™ºæ³¨å±¥æ­´"]
    }
)
```

**æœŸå¾…ã•ã‚Œã‚‹æˆæœ**:
- ã€Œåœ¨åº«åˆ‡ã‚Œãƒªã‚¹ã‚¯ãŒé«˜ã„å•†å“ã¯ï¼Ÿã€
- ã€Œæ¥æœˆã®å…¥è·äºˆå®šã§éœ€è¦ã‚’ã‚«ãƒãƒ¼ã§ãã‚‹ï¼Ÿã€
- ã€Œä»•å…¥å…ˆAã®ç´æœŸé…å»¶å‚¾å‘ã¯ï¼Ÿã€

#### **1.2 Excelæ©Ÿèƒ½çµ±åˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**

```python
# æ–°è¦å®Ÿè£…ææ¡ˆ: Excel-RAGçµ±åˆã‚·ã‚¹ãƒ†ãƒ 
class ExcelRAGIntegration:
    """Excelå½¢å¼ã¨RAGã‚·ã‚¹ãƒ†ãƒ ã®å®Œå…¨çµ±åˆ"""
    
    def __init__(self, config: dict):
        self.config = config
        self.excel_parser = ExcelParser()
        self.rag_processor = RAGProcessor()
    
    def process_excel_file(self, excel_path: str, config: dict) -> dict:
        """Excelãƒ•ã‚¡ã‚¤ãƒ«ã®å®Œå…¨RAGå‡¦ç†"""
        
        # Step 1: Excelæ§‹é€ è§£æ
        excel_structure = self.excel_parser.analyze_structure(excel_path)
        
        # Step 2: ãƒ‡ãƒ¼ã‚¿ã‚¿ã‚¤ãƒ—è‡ªå‹•åˆ¤å®š
        data_types = self.excel_parser.detect_data_types(excel_structure)
        
        # Step 3: ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£è‡ªå‹•èªè­˜
        entities = self.excel_parser.extract_entities(
            excel_structure, 
            language="japanese",
            business_domain=config.get("domain", "general")
        )
        
        # Step 4: JSONå¤‰æ›
        json_data = self.excel_parser.convert_to_json(
            excel_structure,
            preserve_formatting=True,
            include_metadata=True
        )
        
        # Step 5: RAGãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
        rag_metadata = self.rag_processor.generate_metadata(
            json_data,
            entities=entities,
            purpose=config["rag_purpose"],
            excel_source=excel_path
        )
        
        return {
            "json_data": json_data,
            "rag_metadata": rag_metadata,
            "excel_metadata": {
                "source_file": excel_path,
                "sheets": excel_structure["sheets"],
                "data_types": data_types,
                "entities": entities
            }
        }
    
    def create_sphinx_integration(self, processed_data: dict) -> str:
        """Sphinxæ–‡æ›¸ã®è‡ªå‹•ç”Ÿæˆ"""
        
        template = """
{title}
{title_underline}

**ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**: {excel_file}
**æœ€çµ‚æ›´æ–°**: {update_time}
**ãƒ‡ãƒ¼ã‚¿æ¦‚è¦**: {data_summary}

.. enhanced-jsontable:: {json_file}
   :rag-metadata: true
   :rag-purpose: {rag_purpose}
   :entity-types: {entity_types}
   :excel-source: {excel_file}
   :auto-update: {auto_update}
   :data-quality-score: {quality_score}
   :header:

**AIæ´»ç”¨ä¾‹**

ã“ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ãªè³ªå•ãŒå¯èƒ½ã§ã™ï¼š

{example_queries}

**ãƒ‡ãƒ¼ã‚¿å“è³ªæƒ…å ±**

- **å®Œå…¨æ€§**: {completeness}%
- **ä¸€è²«æ€§**: {consistency}%  
- **ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£èªè­˜ç²¾åº¦**: {entity_accuracy}%
"""
        
        return template.format(
            title=processed_data["excel_metadata"]["inferred_title"],
            title_underline="=" * len(processed_data["excel_metadata"]["inferred_title"]),
            excel_file=processed_data["excel_metadata"]["source_file"],
            json_file=processed_data["json_data"]["output_file"],
            rag_purpose=processed_data["rag_metadata"]["purpose"],
            entity_types=",".join(processed_data["rag_metadata"]["entity_types"]),
            quality_score=processed_data["rag_metadata"]["quality_score"],
            example_queries="\n".join([f"- {q}" for q in processed_data["rag_metadata"]["example_queries"]]),
            update_time=processed_data["excel_metadata"]["last_modified"],
            data_summary=processed_data["rag_metadata"]["data_summary"],
            auto_update=processed_data.get("auto_update", "manual"),
            completeness=processed_data["rag_metadata"]["quality_metrics"]["completeness"],
            consistency=processed_data["rag_metadata"]["quality_metrics"]["consistency"],
            entity_accuracy=processed_data["rag_metadata"]["quality_metrics"]["entity_accuracy"]
        )
```

#### **1.3 Excelå½¢å¼å¯¾å¿œãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³**

```python
# å¤šæ§˜ãªExcelå½¢å¼ã¸ã®å¯¾å¿œ
class ExcelFormatHandler:
    """æ§˜ã€…ãªExcelå½¢å¼ã«å¯¾å¿œ"""
    
    def handle_pivot_table(self, excel_file: str, sheet: str) -> dict:
        """ãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«ã®å‡¦ç†"""
        pivot_data = pd.read_excel(excel_file, sheet_name=sheet)
        
        # ãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ã®è§£æ
        pivot_structure = self._analyze_pivot_structure(pivot_data)
        
        # ãƒ•ãƒ©ãƒƒãƒˆå½¢å¼ã¸ã®å¤‰æ›
        flat_data = self._pivot_to_flat(pivot_data, pivot_structure)
        
        return {
            "flat_data": flat_data,
            "pivot_metadata": pivot_structure,
            "rag_optimization": "pivot-aware"
        }
    
    def handle_multiple_headers(self, excel_file: str, sheet: str) -> dict:
        """è¤‡æ•°è¡Œãƒ˜ãƒƒãƒ€ãƒ¼ã®å‡¦ç†"""
        # è¤‡æ•°è¡Œãƒ˜ãƒƒãƒ€ãƒ¼ã®è‡ªå‹•æ¤œå‡ºã¨çµ±åˆ
        raw_data = pd.read_excel(excel_file, sheet_name=sheet, header=None)
        header_rows = self._detect_header_rows(raw_data)
        
        # çµ±åˆãƒ˜ãƒƒãƒ€ãƒ¼ã®ä½œæˆ
        unified_headers = self._create_unified_headers(raw_data, header_rows)
        
        # ãƒ‡ãƒ¼ã‚¿ã®æ­£è¦åŒ–
        normalized_data = self._normalize_data(raw_data, header_rows, unified_headers)
        
        return {
            "normalized_data": normalized_data,
            "header_metadata": {
                "original_headers": header_rows,
                "unified_headers": unified_headers
            }
        }
    
    def handle_financial_format(self, excel_file: str) -> dict:
        """è²¡å‹™ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼ˆæç›Šè¨ˆç®—æ›¸ã€è²¸å€Ÿå¯¾ç…§è¡¨ç­‰ï¼‰ã®å‡¦ç†"""
        # è²¡å‹™è«¸è¡¨ç‰¹æœ‰ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆèªè­˜
        financial_structure = self._detect_financial_structure(excel_file)
        
        # å‹˜å®šç§‘ç›®ã®è‡ªå‹•èªè­˜
        account_items = self._extract_account_items(financial_structure)
        
        # æœŸé–“æ¯”è¼ƒãƒ‡ãƒ¼ã‚¿ã®æŠ½å‡º
        period_comparison = self._extract_period_data(financial_structure)
        
        return {
            "financial_data": financial_structure,
            "account_mapping": account_items,
            "period_analysis": period_comparison,
            "rag_purpose": "financial-analysis"
        }
```

### **2. å…·ä½“çš„ãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹è¨­è¨ˆï¼ˆExcelçµ±åˆå«ã‚€ï¼‰**

#### **2.1 ä¼æ¥­ãƒ‡ãƒ¼ã‚¿æ´»ç”¨ã‚·ãƒŠãƒªã‚ª**

**ã‚·ãƒŠãƒªã‚ªA: å–¶æ¥­ç®¡ç†Excel â†’ RAG**
```python
# å®Ÿéš›ã®å–¶æ¥­ç®¡ç†Excelãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†ä¾‹
sales_integration = ExcelRAGIntegration({
    "domain": "sales",
    "language": "japanese",
    "auto_entity_detection": True
})

# Excelãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†
result = sales_integration.process_excel_file(
    excel_path="å–¶æ¥­å®Ÿç¸¾ç®¡ç†.xlsx",
    config={
        "rag_purpose": "sales-management",
        "sheets": ["æœˆæ¬¡å®Ÿç¸¾", "é¡§å®¢ãƒã‚¹ã‚¿", "å•†å“ãƒã‚¹ã‚¿"],
        "entity_mapping": {
            "å–¶æ¥­æ‹…å½“": "sales_rep",
            "é¡§å®¢å": "customer",
            "å•†å“å": "product", 
            "å£²ä¸Šé‡‘é¡": "revenue",
            "åœ°åŸŸ": "region"
        },
        "auto_update": "daily"
    }
)

# Sphinxæ–‡æ›¸è‡ªå‹•ç”Ÿæˆ
sphinx_doc = sales_integration.create_sphinx_integration(result)
```

**ç”Ÿæˆã•ã‚Œã‚‹æ–‡æ›¸ä¾‹**:
```rst
å–¶æ¥­å®Ÿç¸¾ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
====================

**ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**: å–¶æ¥­å®Ÿç¸¾ç®¡ç†.xlsx
**æœ€çµ‚æ›´æ–°**: 2025-06-10 14:00
**ãƒ‡ãƒ¼ã‚¿æ¦‚è¦**: æœˆæ¬¡å–¶æ¥­å®Ÿç¸¾ãƒ‡ãƒ¼ã‚¿ï¼ˆ1,234ä»¶ï¼‰ã€é¡§å®¢ãƒã‚¹ã‚¿ï¼ˆ456ç¤¾ï¼‰ã€å•†å“ãƒã‚¹ã‚¿ï¼ˆ89ç¨®ï¼‰

.. enhanced-jsontable:: sales_data.json
   :rag-metadata: true
   :rag-purpose: sales-management
   :entity-types: sales_rep,customer,product,revenue,region
   :excel-source: å–¶æ¥­å®Ÿç¸¾ç®¡ç†.xlsx
   :auto-update: daily
   :data-quality-score: 0.94
   :header:

**AIæ´»ç”¨ä¾‹**

ã“ã®ãƒ†ãƒ¼ãƒ–ãƒ«ãƒ‡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ã€ä»¥ä¸‹ã®ã‚ˆã†ãªè³ªå•ãŒå¯èƒ½ã§ã™ï¼š

- é–¢æ±åœ°åŸŸã§ä»Šæœˆã®å£²ä¸Šãƒˆãƒƒãƒ—3ã®å–¶æ¥­æ‹…å½“è€…ã¯ï¼Ÿ
- å•†å“Aã®éå»6ãƒ¶æœˆã®å£²ä¸Šãƒˆãƒ¬ãƒ³ãƒ‰ã‚’æ•™ãˆã¦
- å‰å¹´åŒæœˆæ¯”ã§æˆé•·ç‡ãŒé«˜ã„é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¯ï¼Ÿ
- å–¶æ¥­ç›®æ¨™æœªé”ã®æ‹…å½“è€…ã¨åŸå› åˆ†æã¯ï¼Ÿ

**ãƒ‡ãƒ¼ã‚¿å“è³ªæƒ…å ±**

- **å®Œå…¨æ€§**: 94%
- **ä¸€è²«æ€§**: 98%  
- **ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£èªè­˜ç²¾åº¦**: 96%
```

**ã‚·ãƒŠãƒªã‚ªB: åœ¨åº«ç®¡ç†Excel â†’ RAG**
```python
# åœ¨åº«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®å®Œå…¨è‡ªå‹•åŒ–
inventory_integration = ExcelRAGIntegration({
    "domain": "inventory",
    "include_formulas": True,  # Excelæ•°å¼ã®ä¿æŒ
    "alert_thresholds": True   # åœ¨åº«ã‚¢ãƒ©ãƒ¼ãƒˆæƒ…å ±
})

result = inventory_integration.process_excel_file(
    excel_path="åœ¨åº«ç®¡ç†ãƒã‚¹ã‚¿.xlsx",
    config={
        "rag_purpose": "inventory-optimization",
        "sheets": ["ç¾åœ¨åœ¨åº«", "å®‰å…¨åœ¨åº«", "ç™ºæ³¨å±¥æ­´", "ç´æœŸç®¡ç†"],
        "cross_sheet_relations": {
            "å•†å“ã‚³ãƒ¼ãƒ‰": "primary_key",
            "ä»•å…¥å…ˆã‚³ãƒ¼ãƒ‰": "foreign_key"
        },
        "business_rules": {
            "safety_stock_alerts": True,
            "lead_time_analysis": True,
            "abc_analysis": True
        }
    }
)
```

**æœŸå¾…ã•ã‚Œã‚‹è³ªå•å¿œç­”ä¾‹**:
- ã€Œæ¥é€±ã¾ã§ã«åœ¨åº«åˆ‡ã‚Œãƒªã‚¹ã‚¯ãŒã‚ã‚‹å•†å“ã¯ï¼Ÿã€
- ã€Œä»•å…¥å…ˆAã®å¹³å‡ç´æœŸã¨é…å»¶å‚¾å‘ã¯ï¼Ÿã€
- ã€ŒABCåˆ†æã§Aåˆ†é¡å•†å“ã®å›è»¢ç‡ã¯ï¼Ÿã€
- ã€Œå­£ç¯€å¤‰å‹•ã‚’è€ƒæ…®ã—ãŸæœ€é©ç™ºæ³¨é‡ã¯ï¼Ÿã€

#### **2.2 æ¥­ç•Œç‰¹åŒ–Excelé€£æº**

**è£½é€ æ¥­: ç”Ÿç”£ç®¡ç†Excel**
```python
# ç”Ÿç”£ç®¡ç†ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†
manufacturing_config = {
    "domain": "manufacturing",
    "rag_purpose": "production-management",
    "specialized_entities": {
        "è¨­å‚™å": "equipment",
        "ä½œæ¥­è€…": "operator", 
        "å·¥ç¨‹": "process",
        "å“è³ªæŒ‡æ¨™": "quality_metric",
        "ç¨¼åƒç‡": "utilization_rate"
    },
    "kpi_extraction": True,
    "trend_analysis": True
}
```

**å°å£²æ¥­: è²©å£²åˆ†æExcel**
```python
# è²©å£²ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†
retail_config = {
    "domain": "retail",
    "rag_purpose": "sales-analysis",
    "seasonal_patterns": True,
    "customer_segmentation": True,
    "specialized_entities": {
        "å•†å“ã‚«ãƒ†ã‚´ãƒª": "category",
        "åº—èˆ—": "store",
        "è²©å£²æ•°é‡": "quantity",
        "å®¢å˜ä¾¡": "average_order_value"
    }
}
```

**é‡‘èæ¥­: ãƒªã‚¹ã‚¯ç®¡ç†Excel**
```python
# ãƒªã‚¹ã‚¯ç®¡ç†ãƒ‡ãƒ¼ã‚¿ã®å‡¦ç†  
finance_config = {
    "domain": "finance",
    "rag_purpose": "risk-management",
    "compliance_mode": True,
    "specialized_entities": {
        "é¡§å®¢ID": "customer_id",
        "ä¸ä¿¡é™åº¦é¡": "credit_limit",
        "ãƒªã‚¹ã‚¯ã‚¹ã‚³ã‚¢": "risk_score",
        "æ‹…ä¿è©•ä¾¡é¡": "collateral_value"
    },
    "sensitivity_analysis": True
}
```

### **3. Excelçµ±åˆã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**

#### **3.1 Excelâ†’JSONå¤‰æ›ã‚¨ãƒ³ã‚¸ãƒ³**

```python
class AdvancedExcelConverter:
    """é«˜åº¦ãªExcelâ†’JSONå¤‰æ›ã‚¨ãƒ³ã‚¸ãƒ³"""
    
    def __init__(self):
        self.format_handlers = {
            'pivot_table': PivotTableHandler(),
            'financial_statement': FinancialStatementHandler(),
            'multi_header': MultiHeaderHandler(),
            'cross_tab': CrossTabHandler(),
            'time_series': TimeSeriesHandler()
        }
    
    def auto_detect_format(self, excel_file: str) -> str:
        """Excelå½¢å¼ã®è‡ªå‹•åˆ¤å®š"""
        wb = openpyxl.load_workbook(excel_file)
        
        for sheet_name in wb.sheetnames:
            sheet = wb[sheet_name]
            
            # ãƒ”ãƒœãƒƒãƒˆãƒ†ãƒ¼ãƒ–ãƒ«æ¤œå‡º
            if self._has_pivot_indicators(sheet):
                return 'pivot_table'
            
            # è²¡å‹™è«¸è¡¨æ¤œå‡º
            if self._has_financial_indicators(sheet):
                return 'financial_statement'
            
            # è¤‡æ•°è¡Œãƒ˜ãƒƒãƒ€ãƒ¼æ¤œå‡º
            if self._has_multi_headers(sheet):
                return 'multi_header'
            
            # ã‚¯ãƒ­ã‚¹è¡¨æ¤œå‡º
            if self._has_crosstab_structure(sheet):
                return 'cross_tab'
            
            # æ™‚ç³»åˆ—ãƒ‡ãƒ¼ã‚¿æ¤œå‡º
            if self._has_time_series_pattern(sheet):
                return 'time_series'
        
        return 'standard_table'
    
    def convert_with_intelligence(self, excel_file: str, config: dict) -> dict:
        """ã‚¤ãƒ³ãƒ†ãƒªã‚¸ã‚§ãƒ³ãƒˆãªExcelå¤‰æ›"""
        
        # 1. å½¢å¼è‡ªå‹•åˆ¤å®š
        detected_format = self.auto_detect_format(excel_file)
        handler = self.format_handlers[detected_format]
        
        # 2. ã‚¹ãƒãƒ¼ãƒˆå¤‰æ›
        conversion_result = handler.convert(excel_file, config)
        
        # 3. ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£æŠ½å‡º
        entities = self._extract_business_entities(
            conversion_result['data'],
            domain=config.get('domain', 'general')
        )
        
        # 4. ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ
        metadata = self._generate_comprehensive_metadata(
            conversion_result,
            entities,
            config
        )
        
        # 5. å“è³ªè©•ä¾¡
        quality_score = self._assess_data_quality(
            conversion_result['data'],
            metadata
        )
        
        return {
            'json_data': conversion_result['data'],
            'format_type': detected_format,
            'entities': entities,
            'metadata': metadata,
            'quality_score': quality_score,
            'conversion_notes': conversion_result['notes']
        }
```

#### **3.2 è‡ªå‹•Sphinxçµ±åˆ**

```python
class AutoSphinxIntegration:
    """Excelâ†’JSONâ†’Sphinxæ–‡æ›¸ã®è‡ªå‹•çµ±åˆ"""
    
    def create_complete_documentation(self, conversion_result: dict, config: dict) -> dict:
        """å®Œå…¨ãªæ–‡æ›¸åŒ–ã®è‡ªå‹•ç”Ÿæˆ"""
        
        # 1. ãƒ¡ã‚¤ãƒ³æ–‡æ›¸ä½œæˆ
        main_doc = self._create_main_document(conversion_result, config)
        
        # 2. ã‚µãƒ–ãƒšãƒ¼ã‚¸ä½œæˆï¼ˆãƒ‡ãƒ¼ã‚¿ãŒå¤§ãã„å ´åˆï¼‰
        sub_docs = self._create_sub_documents(conversion_result, config)
        
        # 3. ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ä½œæˆ
        index_doc = self._create_index_document(conversion_result, main_doc, sub_docs)
        
        # 4. è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«æ›´æ–°
        sphinx_config = self._update_sphinx_config(conversion_result, config)
        
        return {
            'main_document': main_doc,
            'sub_documents': sub_docs,
            'index_document': index_doc,
            'sphinx_config': sphinx_config,
            'file_structure': self._create_file_structure(conversion_result)
        }
    
    def _create_main_document(self, conversion_result: dict, config: dict) -> str:
        """ãƒ¡ã‚¤ãƒ³æ–‡æ›¸ã®ç”Ÿæˆ"""
        
        template = """
{title}
{title_underline}

.. meta::
   :description: {description}
   :keywords: {keywords}

æ¦‚è¦
----

**ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹**: :file:`{excel_source}`

**ãƒ‡ãƒ¼ã‚¿æ¦‚è¦**: {data_summary}

**æœ€çµ‚æ›´æ–°**: {last_updated}

**å“è³ªã‚¹ã‚³ã‚¢**: {quality_score}/1.0

ãƒ‡ãƒ¼ã‚¿æ§‹é€ 
----------

{data_structure_info}

.. enhanced-jsontable:: {json_file}
   :rag-metadata: true
   :rag-purpose: {rag_purpose}
   :entity-types: {entity_types}
   :excel-source: {excel_source}
   :auto-update: {auto_update}
   :data-quality-score: {quality_score}
   :format-type: {format_type}
   :header:

AIæ´»ç”¨ã‚¬ã‚¤ãƒ‰
-----------

ã“ã®ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«å¯¾ã™ã‚‹è³ªå•ä¾‹
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

{example_queries}

é«˜åº¦ãªåˆ†æã‚¯ã‚¨ãƒª
~~~~~~~~~~~~~~~

{advanced_queries}

ãƒ‡ãƒ¼ã‚¿å“è³ªãƒ¬ãƒãƒ¼ãƒˆ
-----------------

{quality_report}

æ›´æ–°å±¥æ­´
--------

{update_history}

é–¢é€£æƒ…å ±
--------

{related_links}
"""
        
        return template.format(
            title=config.get('title', self._infer_title(conversion_result)),
            title_underline='=' * len(config.get('title', self._infer_title(conversion_result))),
            description=conversion_result['metadata']['description'],
            keywords=', '.join(conversion_result['metadata']['keywords']),
            excel_source=conversion_result['metadata']['source_file'],
            data_summary=conversion_result['metadata']['summary'],
            last_updated=conversion_result['metadata']['last_updated'],
            quality_score=conversion_result['quality_score'],
            json_file=conversion_result['json_data']['output_file'],
            rag_purpose=config['rag_purpose'],
            entity_types=','.join(conversion_result['entities']['types']),
            auto_update=config.get('auto_update', 'manual'),
            format_type=conversion_result['format_type'],
            data_structure_info=self._format_structure_info(conversion_result),
            example_queries=self._format_queries(conversion_result['metadata']['example_queries']),
            advanced_queries=self._format_queries(conversion_result['metadata']['advanced_queries']),
            quality_report=self._format_quality_report(conversion_result['metadata']['quality_metrics']),
            update_history=self._format_update_history(conversion_result['metadata']['update_history']),
            related_links=self._format_related_links(conversion_result['metadata']['related_files'])
        )
```

### **4. å®Ÿè£…ä¾‹ã¨ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ï¼ˆExcelçµ±åˆï¼‰**

#### **4.1 Excelé€£æºã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ**

```markdown
# ğŸ“Š Excel â†’ RAGçµ±åˆ å®Œå…¨ã‚¬ã‚¤ãƒ‰

## ğŸš€ 5åˆ†ã§Excelãƒ‡ãƒ¼ã‚¿ã‚’AIå¯¾å¿œã«

### Step 1: Excelæº–å‚™
```excel
å–¶æ¥­å®Ÿç¸¾.xlsx
â”œâ”€â”€ æœˆæ¬¡å®Ÿç¸¾ (ã‚·ãƒ¼ãƒˆ)
â”‚   â”œâ”€â”€ å–¶æ¥­æ‹…å½“ | é¡§å®¢å | å•†å“å | å£²ä¸Šé‡‘é¡ | åœ°åŸŸ
â”‚   â”œâ”€â”€ ç”°ä¸­å¤ªéƒ | ABCå•†äº‹ | å•†å“A | 1,500,000 | é–¢æ±
â”‚   â””â”€â”€ ...
â”œâ”€â”€ é¡§å®¢ãƒã‚¹ã‚¿ (ã‚·ãƒ¼ãƒˆ)
â””â”€â”€ å•†å“ãƒã‚¹ã‚¿ (ã‚·ãƒ¼ãƒˆ)
```

### Step 2: è‡ªå‹•å¤‰æ›
```python
from sphinxcontrib.jsontable.excel import ExcelRAGConverter

# Excelãƒ•ã‚¡ã‚¤ãƒ«ã®è‡ªå‹•RAGåŒ–
converter = ExcelRAGConverter()
result = converter.convert_excel_to_rag(
    excel_file="å–¶æ¥­å®Ÿç¸¾.xlsx",
    rag_purpose="sales-analysis",
    auto_sphinx_docs=True  # Sphinxæ–‡æ›¸ã‚‚è‡ªå‹•ç”Ÿæˆ
)

print(f"å¤‰æ›å®Œäº†: {result['json_files']}")
print(f"Sphinxæ–‡æ›¸: {result['sphinx_docs']}")
```

### Step 3: å³åº§ã«AIè³ªå•
```python
from sphinxcontrib.jsontable.rag import query_excel_data

# Excelãƒ‡ãƒ¼ã‚¿ã«ç›´æ¥è³ªå•
answer = query_excel_data(
    excel_file="å–¶æ¥­å®Ÿç¸¾.xlsx",
    question="é–¢æ±åœ°åŸŸã§ä»Šæœˆå£²ä¸Šãƒˆãƒƒãƒ—3ã®å–¶æ¥­æ‹…å½“è€…ã¯ï¼Ÿ"
)

print(answer)
# å‡ºåŠ›ä¾‹: "é–¢æ±åœ°åŸŸã®ä»Šæœˆå£²ä¸Šãƒˆãƒƒãƒ—3ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š
# 1. ç”°ä¸­å¤ªéƒ: 4,500,000å††
# 2. ä½è—¤èŠ±å­: 3,800,000å††  
# 3. å±±ç”°æ¬¡éƒ: 3,200,000å††"
```

### Step 4: Sphinxæ–‡æ›¸ç¢ºèª
è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸæ–‡æ›¸:
```rst
å–¶æ¥­å®Ÿç¸¾åˆ†æ
============

.. enhanced-jsontable:: sales_data.json
   :rag-metadata: true
   :rag-purpose: sales-analysis
   :excel-source: å–¶æ¥­å®Ÿç¸¾.xlsx
   :auto-update: daily
   :header:
```

## ğŸ¯ æ¥­ç•Œåˆ¥Excelæ´»ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³

### è£½é€ æ¥­: ç”Ÿç”£ç®¡ç†Excel
```python
# ç”Ÿç”£ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•RAGåŒ–
production_result = converter.convert_excel_to_rag(
    excel_file="ç”Ÿç”£ç®¡ç†.xlsx",
    rag_purpose="production-optimization",
    domain="manufacturing",
    kpi_extraction=True
)

# è³ªå•ä¾‹
questions = [
    "ä»Šæœˆã®è¨­å‚™ç¨¼åƒç‡ãŒä½ã„å·¥ç¨‹ã¯ï¼Ÿ",
    "å“è³ªä¸è‰¯ç‡ãŒå¢—åŠ ã—ã¦ã„ã‚‹è£½å“ã¯ï¼Ÿ",
    "ç´æœŸé…å»¶ãƒªã‚¹ã‚¯ãŒé«˜ã„æ³¨æ–‡ã¯ï¼Ÿ"
]
```

### å°å£²æ¥­: è²©å£²ãƒ‡ãƒ¼ã‚¿Excel
```python
# è²©å£²ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•RAGåŒ–
retail_result = converter.convert_excel_to_rag(
    excel_file="è²©å£²å®Ÿç¸¾.xlsx", 
    rag_purpose="retail-analysis",
    domain="retail",
    seasonal_analysis=True
)

# è³ªå•ä¾‹
questions = [
    "ä»Šæœˆå£²ã‚Œç­‹å•†å“ãƒˆãƒƒãƒ—10ã¯ï¼Ÿ",
    "åº—èˆ—åˆ¥ã®å®¢å˜ä¾¡ãƒˆãƒ¬ãƒ³ãƒ‰ã¯ï¼Ÿ",
    "å­£ç¯€è¦å› ã‚’é™¤ã„ãŸå£²ä¸Šæˆé•·ç‡ã¯ï¼Ÿ"
]
```

### é‡‘èæ¥­: ãƒªã‚¹ã‚¯ç®¡ç†Excel
```python
# ãƒªã‚¹ã‚¯ãƒ‡ãƒ¼ã‚¿ã®è‡ªå‹•RAGåŒ–
risk_result = converter.convert_excel_to_rag(
    excel_file="ãƒªã‚¹ã‚¯ç®¡ç†.xlsx",
    rag_purpose="risk-assessment", 
    domain="finance",
    compliance_mode=True,
    sensitivity_level="high"
)

# è³ªå•ä¾‹
questions = [
    "ä¿¡ç”¨ãƒªã‚¹ã‚¯ãŒé«˜ã„é¡§å®¢ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã¯ï¼Ÿ",
    "ãƒãƒ¼ãƒˆãƒ•ã‚©ãƒªã‚ªã®VaRå€¤ã®æ¨ç§»ã¯ï¼Ÿ",
    "è¦åˆ¶å¤‰æ›´ã®å½±éŸ¿ã‚’å—ã‘ã‚‹å–å¼•ã¯ï¼Ÿ"
]
```

## ğŸ”§ é«˜åº¦ãªExcelé€£æº

### è¤‡é›‘ãªExcelãƒ•ã‚¡ã‚¤ãƒ«ã®å‡¦ç†
```python
# è¤‡æ•°ã‚·ãƒ¼ãƒˆã€è¤‡é›‘æ§‹é€ ã®å‡¦ç†
complex_result = converter.convert_excel_to_rag(
    excel_file="è¤‡åˆãƒ‡ãƒ¼ã‚¿.xlsx",
    config={
        "sheets": {
            "æç›Šè¨ˆç®—æ›¸": {
                "format": "financial_statement",
                "header_rows": 3,
                "entity_mapping": {"ç§‘ç›®": "account_item"}
            },
            "å£²ä¸Šæ˜ç´°": {
                "format": "time_series",
                "date_column": "å£²ä¸Šæ—¥",
                "pivot_summary": True
            },
            "é¡§å®¢åˆ†æ": {
                "format": "pivot_table", 
                "flatten_pivots": True
            }
        },
        "cross_sheet_relations": {
            "é¡§å®¢ã‚³ãƒ¼ãƒ‰": ["å£²ä¸Šæ˜ç´°", "é¡§å®¢åˆ†æ"]
        },
        "federated_rag": True
    }
)
```

### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°å¯¾å¿œ
```python
# Excelå¤‰æ›´ã®è‡ªå‹•æ¤œçŸ¥ã¨æ›´æ–°
from sphinxcontrib.jsontable.excel import ExcelWatcher

watcher = ExcelWatcher()
watcher.watch_file(
    excel_file="å–¶æ¥­å®Ÿç¸¾.xlsx",
    on_change=lambda: converter.auto_update_rag(),
    sphinx_rebuild=True
)

# ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´æ™‚ã®è‡ªå‹•RAGæ›´æ–°
print("Excelãƒ•ã‚¡ã‚¤ãƒ«ç›£è¦–é–‹å§‹...")
```
```

#### **4.2 ä¼æ¥­å°å…¥ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«**

```markdown
# ğŸ¢ ä¼æ¥­Excelè³‡ç”£ã®RAGåŒ–å®Œå…¨ã‚¬ã‚¤ãƒ‰

## ä¼æ¥­ã‚·ãƒŠãƒªã‚ª: æœˆæ¬¡çµŒå–¶ä¼šè­°è³‡æ–™ã®è‡ªå‹•åŒ–

### ç¾çŠ¶ã®èª²é¡Œ
- å„éƒ¨ç½²ã®Excelãƒ•ã‚¡ã‚¤ãƒ«ãŒåˆ†æ•£
- ãƒ‡ãƒ¼ã‚¿çµ±åˆã«æ™‚é–“ãŒã‹ã‹ã‚‹
- è³ªå•ã«ç­”ãˆã‚‹ã®ã«æ‰‹ä½œæ¥­ãŒå¿…è¦

### è§£æ±ºã‚¢ãƒ—ãƒ­ãƒ¼ãƒ

#### Phase 1: ãƒ‡ãƒ¼ã‚¿çµ±åˆ
```python
# è¤‡æ•°éƒ¨ç½²ã®Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’çµ±åˆ
departments = {
    "sales": "å–¶æ¥­éƒ¨å®Ÿç¸¾.xlsx",
    "production": "ç”Ÿç”£éƒ¨å®Ÿç¸¾.xlsx", 
    "finance": "è²¡å‹™éƒ¨ãƒ‡ãƒ¼ã‚¿.xlsx",
    "hr": "äººäº‹éƒ¨ãƒ‡ãƒ¼ã‚¿.xlsx"
}

integrated_rag = ExcelRAGFederation()

for dept, excel_file in departments.items():
    result = integrated_rag.add_department_data(
        department=dept,
        excel_file=excel_file,
        rag_purpose=f"{dept}-analysis",
        auto_entity_mapping=True
    )

# éƒ¨ç½²é–“ã‚¯ãƒ­ã‚¹åˆ†æã®æœ‰åŠ¹åŒ–
integrated_rag.enable_cross_department_analysis(
    relationships={
        "å¾“æ¥­å“¡ID": ["sales", "hr"],
        "è£½å“ã‚³ãƒ¼ãƒ‰": ["sales", "production"],
        "ã‚³ã‚¹ãƒˆã‚»ãƒ³ã‚¿ãƒ¼": ["production", "finance"]
    }
)
```

#### Phase 2: çµŒå–¶ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ä½œæˆ
```rst
æœˆæ¬¡çµŒå–¶ä¼šè­°è³‡æ–™
===============

å£²ä¸Šåˆ†æ
--------

.. enhanced-jsontable:: sales_summary.json
   :rag-metadata: true
   :rag-purpose: executive-summary
   :federated-sources: sales,production,finance
   :excel-sources: å–¶æ¥­éƒ¨å®Ÿç¸¾.xlsx,ç”Ÿç”£éƒ¨å®Ÿç¸¾.xlsx,è²¡å‹™éƒ¨ãƒ‡ãƒ¼ã‚¿.xlsx
   :executive-dashboard: true
   :header:

**ã‚¨ã‚°ã‚¼ã‚¯ãƒ†ã‚£ãƒ–è³ªå•ä¾‹**:

- ä»Šæœˆã®å£²ä¸Šç›®æ¨™é”æˆçŠ¶æ³ã¯ï¼Ÿ
- ã‚³ã‚¹ãƒˆå¢—åŠ ã®ä¸»è¦å› ã¯ï¼Ÿ
- äººå“¡é…ç½®ã®æœ€é©åŒ–ææ¡ˆã¯ï¼Ÿ
- æ¬¡å››åŠæœŸã®ãƒªã‚¹ã‚¯è¦å› ã¯ï¼Ÿ
```

#### Phase 3: AIæ´»ç”¨ã®çµ„ç¹”å±•é–‹
```python
# å½¹è·åˆ¥è³ªå•ãƒ‘ã‚¿ãƒ¼ãƒ³ã®è¨­å®š
executive_queries = ExcelRAGQueryManager()

# CEOå‘ã‘è³ªå•ãƒ‘ã‚¿ãƒ¼ãƒ³
executive_queries.add_persona("CEO", [
    "å…¨ç¤¾æ¥­ç¸¾ã‚µãƒãƒªãƒ¼ã¨å‰å¹´æ¯”è¼ƒ",
    "ä¸»è¦KPIã®é”æˆçŠ¶æ³",
    "æˆ¦ç•¥çš„ãƒªã‚¹ã‚¯ã¨æ©Ÿä¼š",
    "æŠ•è³‡ROIã¨ä»Šå¾Œã®æ–¹é‡"
])

# å–¶æ¥­éƒ¨é•·å‘ã‘è³ªå•ãƒ‘ã‚¿ãƒ¼ãƒ³
executive_queries.add_persona("Sales_Manager", [
    "å£²ä¸Šç›®æ¨™ã¨ã®ä¹–é›¢åˆ†æ",
    "å–¶æ¥­æ‹…å½“åˆ¥ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹",
    "æ–°è¦é¡§å®¢ç²å¾—çŠ¶æ³", 
    "å•†å“åˆ¥å£²ä¸Šãƒˆãƒ¬ãƒ³ãƒ‰"
])

# è‡ªå‹•ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
monthly_report = executive_queries.generate_executive_report(
    target_personas=["CEO", "Sales_Manager", "Production_Manager"],
    data_sources=integrated_rag
)
```
```

### **5. README.md é©æ–°çš„ãƒªãƒ‹ãƒ¥ãƒ¼ã‚¢ãƒ«**

```markdown
# ğŸ“Š sphinxcontrib-jsontable: Excel-to-AI Documentation Revolution

## ğŸ¯ Transform Your Excel Files into Intelligent Knowledge Bases

### The Problem We Solve
âŒ **Before**: Scattered Excel files, manual data analysis, time-consuming reporting  
âœ… **After**: AI-powered insights from Excel data in 5 minutes

## ğŸš€ Excel â†’ AI in 3 Steps

### Step 1: Point to Your Excel File
```python
from sphinxcontrib.jsontable.excel import ExcelRAGConverter

converter = ExcelRAGConverter()
result = converter.convert_excel_to_rag(
    excel_file="sales_data.xlsx",
    rag_purpose="sales-analysis"
)
```

### Step 2: Ask Questions in Natural Language
```python
from sphinxcontrib.jsontable.rag import query_excel_data

answer = query_excel_data(
    excel_file="sales_data.xlsx",
    question="Who are the top 3 sales reps this quarter?"
)
```

### Step 3: Get Intelligent Documentation
Automatically generated Sphinx documentation with RAG capabilities:
```rst
.. enhanced-jsontable:: sales_data.json
   :rag-metadata: true
   :excel-source: sales_data.xlsx
   :auto-update: daily
```

## ğŸ¯ Real-World Excel Use Cases

### ğŸ“ˆ Sales & CRM
**Excel File**: `sales_report.xlsx`  
**AI Questions**: 
- "Which regions are underperforming this quarter?"
- "What's the pipeline value for next month?"
- "Show me churned customers and reasons"

### ğŸ­ Manufacturing & Operations  
**Excel File**: `production_data.xlsx`  
**AI Questions**:
- "Which machines have declining efficiency?"
- "What's causing quality issues in Line 3?"
- "Predict maintenance needs for next week"

### ğŸ’° Finance & Accounting
**Excel File**: `financial_statements.xlsx`  
**AI Questions**:
- "Analyze cash flow trends over 12 months"  
- "Which cost centers exceed budget?"
- "Calculate ROI for recent investments"

### ğŸ‘¥ HR & People Analytics
**Excel File**: `employee_data.xlsx`  
**AI Questions**:
- "Who are flight risks in engineering?"
- "What skills gaps exist in our teams?"
- "Analyze compensation equity across departments"

## ğŸ“Š Supported Excel Formats

| Excel Format | Auto-Detection | RAG Optimization | Example |
|--------------|----------------|------------------|---------|
| **Standard Tables** | âœ… | Smart chunking | Sales reports, inventory |
| **Pivot Tables** | âœ… | Pivot-aware processing | Management dashboards |
| **Financial Statements** | âœ… | Account recognition | P&L, Balance sheets |
| **Multi-header Tables** | âœ… | Header unification | Survey data, cross-tabs |
| **Time Series** | âœ… | Temporal analysis | Monthly reports, trends |

## ğŸ”§ Integration Ecosystem

### Excel â†’ Multiple RAG Systems
```python
# OpenAI Integration
converter.set_rag_system("openai", {
    "model": "text-embedding-3-small",
    "api_key": "your-key"
})

# LangChain Integration  
converter.set_rag_system("langchain", {
    "vectorstore": "chroma",
    "llm": "gpt-3.5-turbo"
})

# Custom RAG System
converter.set_rag_system("custom", {
    "endpoint": "https://your-rag-api.com"
})
```

### Enterprise Features
```python
# Multi-department Excel federation
federation = ExcelRAGFederation()
federation.add_department("sales", "sales_data.xlsx")
federation.add_department("finance", "finance_data.xlsx") 
federation.enable_cross_analysis()

# Real-time Excel monitoring
watcher = ExcelWatcher()
watcher.watch_directory("/company/reports/", auto_update=True)
```

## ğŸ¯ Business Impact

### Proven Results Across Industries

| Industry | Use Case | Time Saved | Accuracy Gain |
|----------|----------|------------|---------------|
| **Manufacturing** | Production reports | 85% | 92% |
| **Retail** | Sales analysis | 90% | 94% |
| **Finance** | Risk assessment | 80% | 96% |
| **Healthcare** | Patient analytics | 75% | 98% |

### ROI Calculator
```python
# Calculate your potential ROI
from sphinxcontrib.jsontable.calculator import ROICalculator

calculator = ROICalculator()
roi = calculator.estimate_savings(
    excel_files_per_month=50,
    analysts_hours_per_file=4,
    hourly_rate=75
)
print(f"Estimated annual savings: ${roi['annual_savings']:,}")
# Output: Estimated annual savings: $156,000
```

## ğŸ“š Complete Documentation

- ğŸš€ **[5-Minute Quick Start](docs/quickstart.md)**: Excel to AI in minutes
- ğŸ“Š **[Excel Integration Guide](docs/excel-integration.md)**: Complete Excel support
- ğŸ”§ **[RAG System Integrations](docs/rag-integrations.md)**: OpenAI, LangChain, Custom
- ğŸ¢ **[Enterprise Deployment](docs/enterprise.md)**: Scale, Security, Compliance
- ğŸ¯ **[Industry Use Cases](docs/use-cases.md)**: Real implementations
- ğŸ” **[API Reference](docs/api.md)**: Complete documentation

## ğŸŒŸ Why Choose Excel-RAG Integration?

| Feature | Manual Process | Other Tools | **jsontable Excel-RAG** |
|---------|----------------|-------------|------------------------|
| **Setup Time** | Days/Weeks | Hours | **5 Minutes** |
| **Excel Support** | Manual coding | Limited | **Native & Complete** |
| **Japanese Support** | None | Basic | **95%+ Accuracy** |
| **Cost** | Development time | Licensing | **Open Source** |
| **Maintenance** | Ongoing | Manual | **Automatic** |

Ready to revolutionize your Excel workflows with AI?  
[**Start Now â†’**](docs/quickstart.md) | [**See Examples â†’**](docs/examples.md) | [**Enterprise Demo â†’**](docs/enterprise-demo.md)
```

---

## ğŸ¯ **å®Ÿè£…å®Œäº†äºˆæƒ³æˆæœ**

### **Excelçµ±åˆã«ã‚ˆã‚‹é©å‘½çš„æ”¹å–„**
- **å°å…¥æ™‚é–“**: Excelåˆ†æ æ•°æ™‚é–“ â†’ 5åˆ†ï¼ˆ98%çŸ­ç¸®ï¼‰
- **å¯¾å¿œå½¢å¼**: è¤‡é›‘ãªExcelå½¢å¼ã¸ã®å®Œå…¨å¯¾å¿œ
- **è‡ªå‹•åŒ–åº¦**: æ‰‹ä½œæ¥­ â†’ å®Œå…¨è‡ªå‹•ï¼ˆäººçš„å·¥æ•°90%å‰Šæ¸›ï¼‰
- **ãƒ“ã‚¸ãƒã‚¹ä¾¡å€¤**: ä¼æ¥­ã®æ—¢å­˜Excelè³‡ç”£ã‚’å³åº§ã«AIæ´»ç”¨

### **ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£é©å‘½**
- **å­¦ç¿’ã‚³ã‚¹ãƒˆ**: æŠ€è¡“çŸ¥è­˜ä¸è¦ã€Excelãƒ¦ãƒ¼ã‚¶ãƒ¼ãªã‚‰å³åˆ©ç”¨å¯èƒ½
- **çµ±åˆæ€§**: æ—¢å­˜ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã¨ã®å®Œå…¨çµ±åˆ
- **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**: 1ãƒ•ã‚¡ã‚¤ãƒ« â†’ ä¼æ¥­å…¨ä½“ã®Excelè³‡ç”£
- **ROI**: å¹´é–“10-50ä¸‡ãƒ‰ãƒ«ã®ã‚³ã‚¹ãƒˆå‰Šæ¸›ï¼ˆä¸­ä¼æ¥­è¦æ¨¡ï¼‰

ã“ã®åŒ…æ‹¬çš„æ”¹å–„ã«ã‚ˆã‚Šã€æŠ€è¡“çš„ã«å„ªç§€ãªRAGçµ±åˆæ©Ÿèƒ½ãŒ **å®Ÿéš›ã«ä½¿ã‚ã‚Œã‚‹è£½å“** ã«å¤‰è²Œã—ã€Excelåˆ©ç”¨ä¼æ¥­ã§ã®åºƒç¯„å›²ãªæ¡ç”¨ãŒæœŸå¾…ã§ãã¾ã™ã€‚

<function_calls>
<invoke name="TodoWrite">
<parameter name="todos">[{"content": "RAG\u7d71\u5408\u5b9f\u7528\u6027\u6539\u5584\u8a08\u753b\u66f8\u4f5c\u6210", "status": "completed", "priority": "high", "id": "1"}, {"content": "\u5177\u4f53\u7684\u30e6\u30fc\u30b9\u30b1\u30fc\u30b9\u660e\u6587\u5316", "status": "completed", "priority": "high", "id": "2"}, {"content": "\u65e2\u5b58RAG\u30b7\u30b9\u30c6\u30e0\u9023\u643a\u65b9\u6cd5\u8a2d\u8a08", "status": "completed", "priority": "high", "id": "3"}, {"content": "\u30e1\u30bf\u30c7\u30fc\u30bf\u6a19\u6e96\u5316\u30fb\u4e92\u63db\u6027\u8a2d\u8a08", "status": "completed", "priority": "high", "id": "4"}, {"content": "\u6bb5\u968e\u7684\u5c0e\u5165\u30d1\u30b9\u8a2d\u8a08", "status": "completed", "priority": "high", "id": "5"}, {"content": "\u5b9f\u88c5\u4f8b\u30fb\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u4f5c\u6210", "status": "completed", "priority": "high", "id": "6"}, {"content": "\u30a2\u30fc\u30ad\u30c6\u30af\u30c1\u30e3\u6539\u5584\u63d0\u6848", "status": "completed", "priority": "high", "id": "7"}, {"content": "Excel\u9023\u643a\u6a5f\u80fd\u8a2d\u8a08\u30fb\u5b9f\u88c5", "status": "completed", "priority": "high", "id": "8"}]